<html><head><meta charset="UTF-8"><link rel="import" href="restaurant-reviewer.html"></head><body><dom-module id="search-results">

  <template>

    <style include="iron-flex iron-flex-alignment">:host{--paper-card:{width:100%;};}*[hidden]{display:none !important;}.loader{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:2em;}.storeImage{width:15em;height:10em;}.card-header:{@apply (--paper-font-headline);};paper-card{border-bottom:1px solid var(--paper-grey-400);}.shopCard a{color:black;text-decoration:none;}.shopCard{color:black;}.shopCard:hover{cursor:pointer;}.card-detail{color:var(--paper-grey-600);}.row{@apply (--layout-horizontal);@apply (--layout-center);@apply (--layout-justified);}.row > *{padding:10px;}.row *:nth-child(1){flex:1 1 25%;align-self:auto;}.row *:nth-child(2){flex:4 1 50%;align-self:auto;}.row *:nth-child(3){flex:0 1 25%;align-self:auto;}@media screen and (max-width: 767px){.row{@apply (--layout-wrap);}}</style>

    <app-route route="{{route}}" query-params="{{queryParams}}">
    </app-route>

    <section hidden$="[[loading]]">
      <h3 id="noResults" hidden$="[[!emptyResults]]">No Results Found</h3>
      <div hidden$="[[emptyResults]]">
        <template is="dom-repeat" items="[[searchResults]]" as="shop">
          <a class="shopCard" href="/restaurant-reviewer/#/business/{{shop.placeId}}">
            <paper-card on-tap="setBusiness">
              <div class="card-content">
                <div class="row">
                  <img class="storeImage" src="[[shop.image]]" alt="restaurant picture">
                  <div>
                    <h3>[[shop.title]]</h3>
                    <star-rating rating="[[shop.rating]]"></star-rating>
                  </div>
                  <div>
                    <p class="card-detail">[[shop.address]]</p>
                    <dollar-rating rating="[[shop.price]]"></dollar-rating>
                  </div>
                </div>
              </div>
            </paper-card>
          </a>
          <br>
        </template>
      </div>
    </section>

    <section class="loader" hidden$="[[!loading]]">
      <paper-spinner active="[[!loading]]"></paper-spinner>
    </section>

  </template>

  <script>Polymer({is:"search-results",properties:{route:{type:Object,notify:!0},data:{type:Object},active:{type:Boolean,notify:!0,value:!1},queryParams:{type:Object,notify:!0},business:{type:Object,notify:!0},searchResults:{type:Array,notify:!0,value:function(){return[]}},map:{type:Object},coords:{},emptyResults:{type:Boolean,notify:!0,value:!0},openNow:{type:Boolean},maxPrice:{type:Number},minPrice:{type:Number},radius:{type:Number},loading:{type:Boolean,value:!1}},observers:["_textSearch(active, queryParams.search, coords, minPrice, maxPrice, radius)"],setBusiness:function(e){this.business=e.model.shop},_fetchImageUrl:function(e){return imageUrl=e.getUrl({maxWidth:1e3,maxHeight:500}),imageUrl},_textSearch:function(e,t,a,s,r,i){var o=this;if(e&&t&&a){this.loading=!0;var n=new google.maps.Map(this.map,{center:a}),c={location:a,minPriceLevel:s,maxPriceLevel:r,query:t,radius:i,type:"restaurant"};void 0!==this.openNow&&(c.openNow=this.openNow);var l=new google.maps.places.PlacesService(n);l.textSearch(c,function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){o.emptyResults=!1;var a=e.splice(0,10);o.parseResults(a),o.loading=!1}else o.emptyResults=!0,o.loading=!1})}},parseResults:function(e){var t=this;this.searchResults=e.map(function(e){var a=e.name,s=e.price_level,r=e.formatted_address,i=e.rating,o=e.place_id,n=e.photos||"https://maps.gstatic.com/tactile/pane/result-no-thumbnail-2x.png",c="string"==typeof n?n:t._fetchImageUrl(n[0]);return{title:a,price:s,address:r,rating:i,image:c,placeId:o}})}});</script>

</dom-module>
</body></html>