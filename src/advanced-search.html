<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="places-input.html">
<link rel="import" href="price-filter.html">
<link rel="import" href="radius-filter.html">
<link rel="import" href="valid-form.html">


<dom-module id="advanced-search">

  <template>

    <style>
     :host {
         --valid-form-button: {
             border-radius: 25%;
             background-color:  #FFE05C;
             flex: 0 1 auto;
             width: 10%;
             /* padding-left: ; */
         }

         --valid-form-form: {
             background-color: white !important;
             flex-wrap: wrap;
             flex-direction: column;
             width: 80%;
         }

         --radius-slider-style,
         --price-slider-style: {
             margin-top: 0 !important;
             width: 20em;
             margin: 1em;
         }
     }

     .card {
         box-shadow: 0 2px 2px 0  rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
         padding: 16px;
         margin: 24px;
         border-radius: 5px;
         background-color: #fff;
         width: 80%;
     }

     paper-input, places-input, paper-toggle-button {
         width: 75%;
         margin: 1em;
     }

    </style>

    <app-route route="{{route}}" query-params="{{queryParams}}">
    </app-route>

    <paper-card class="card">
      <valid-form id="advSearchForm" button="Search">
        <h3>Advanced Search</h3>

        <paper-input label="Business Name or Food Type"
                     ariaLabel="Business Name or Food Type"
                     value="{{searchParams.searchTerm}}"
                     required>
        </paper-input>

        <places-input value="{{location}}"
                      lat="{{latitude}}"
                      lng="{{longitude}}"
                      label="Location"
                      aria-label="your location"
                      required>
        </places-input>

        <paper-dropdown-menu id="openFilter" label="Open Now">
          <paper-listbox class="dropdown-content" selected="{{searchParams.openNow}}">
            <paper-item>Any</paper-item>
            <paper-item>Open</paper-item>
            <paper-item>Closed</paper-item>
          </paper-listbox>
        </paper-dropdown-menu>

        <price-filter max="{{searchParams.maxPrice}}"
                      min="{{searchParams.minPrice}}">
        </price-filter>

        <radius-filter value="{{searchParams.radius}}"></radius-filter>

      </valid-form>
    </paper-card>
  </template>

  <script>

   Polymer({

     is: 'advanced-search',

     behaviors: [
       Polymer.IronValidatableBehavior,
     ],

     properties: {
       route: {
         type: Object,
         notify: true
       },

       queryParams: {
         type: Object,
         notify: true
       },

       location: String,

       latitude: {
         type: Number,
         notify: true
       },

       longitude: {
         type: Number,
         notify: true
       },

       searchParams: Object
     },

     listeners: {
       'advSearchForm.iron-form-submit': '_textSearch'
     },

     // jump to the search-results page
     _textSearch: function() {
       this.set('route.path', '/search');
     }

   });
  </script>

</dom-module>
